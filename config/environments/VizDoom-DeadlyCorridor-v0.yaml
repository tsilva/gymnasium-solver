# =====================
# Environment Specification
# =====================
spec:
  source: https://vizdoom.cs.put.edu.pl/competitions/cig-2017/scenarios/#deadly-corridor
  description: Reach the armor vest through a corridor of enemies; survive and progress forward.

  render_fps: 35

  action_space:
    discrete: 9
    labels: {0: noop, 1: forward, 2: backward, 3: strafe_left, 4: strafe_right, 5: turn_left, 6: turn_right, 7: attack, 8: forward_attack}

  observation_space:
    default: rgb
    variants:
      rgb:
        shape: [height, width, 3]
        dtype: uint8
        range: [0, 255]
        note: Height/width depend on the ViZDoom cfg; wrapper enforces RGB24 and HWC.

  rewards:
    description: Dense shaping towards the vest; penalties for retreat and death.
    components:
      - {name: distance_shaping, sign: positive}
      - {name: retreat_penalty, sign: negative}
      - {name: death_penalty, value: -100.0}
    threshold_solved: 1000
    range: [-100, 1000]

  versions:
    v0: ViZDoom deadly_corridor.cfg scenario

# =====================
# Configuration Anchors
# =====================

_env: &env
  env_id: VizDoom-DeadlyCorridor-v0
  policy: 'cnn'
  policy_kwargs:
    channels: [32, 64, 64]
    kernel_sizes: [8, 4, 3]
    strides: [4, 2, 1]
  grayscale_obs: true
  resize_obs: true
  frame_stack: 4
  accelerator: 'gpu'
  devices: 'auto'
  eval_freq_epochs: 1
  eval_episodes: 1

_ppo: &ppo
  <<: *env
  algo_id: ppo
  max_timesteps: 1e7
  n_envs: 8
  n_steps: 128
  batch_size: 256
  n_epochs: 4
  clip_range: 0.1
  policy_lr: 2.5e-4

ppo:
  <<: *ppo
